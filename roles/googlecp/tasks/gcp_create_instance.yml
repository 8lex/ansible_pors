---
- name: create instance {{ server_shortname }} tasks
  template:
    src: create_instance.j2
    dest: "{{ base_install_dir }}/roles/googlecp/tasks/generated_create_instance.yml"
  connection: local
  loop: "{{ disks }}"

######################################################################
# The GCP ansible modules do not offer to attach disks to an already
# running instance. There is an old module 'gc_pd' but it is
# superseeded by gcp_compute_instance. The latter does not offer an
# 'attach-disk' key (as in gcloud SDK) so atm (2021, Jan) there is no
# way to do this task via the gcp ansible modules.
#
# the following tasks file gets auto-generated by the above template:
######################################################################

- include_tasks: "{{ base_install_dir }}/roles/googlecp/tasks/generated_create_instance.yml"
